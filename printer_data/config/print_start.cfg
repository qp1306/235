#==============================================================================
# Print Start G-code (no cooldown wait if already hot)
#==============================================================================
[gcode_macro PRINT_START]
gcode:
    _SET_FLAP_ENABLED ENABLED=1
    lights_max
    M220 S100
    G90

    # Parameters (safe defaults if slicer doesn't pass them)
    {% set bedtemp    = params.BED|default(60)|int %}
    {% set hotendtemp = params.HOTEND|default(210)|int %}
    {% set overshoot  = params.OVERSHOOT|default(8)|int %}  # allow up to +8Â°C above target

    # Start heating WITHOUT blocking
    M140 S{bedtemp}                 ; set bed (no wait)
    M104 S{hotendtemp}              ; set hotend (no wait)

    # Do motion/setup while heaters climb
    G28                              ; home all axes
    _CLIENT_LINEAR_MOVE Z=5 F=1500
    ; BED_MESH_CALIBRATE ADAPTIVE=0  ; (optional)
    ; NOZZLE_WIPE_LOCATION_READY     ; (optional)

    # Wait logic that only blocks if below target (no wait if already hot)
    TEMPERATURE_WAIT SENSOR=heater_bed MINIMUM={bedtemp}
    TEMPERATURE_WAIT SENSOR=extruder MINIMUM={hotendtemp} MAXIMUM={{ hotendtemp + overshoot }}

    ; NOZZLE_WIPE                    ; (optional)
    PRIME_LINE
