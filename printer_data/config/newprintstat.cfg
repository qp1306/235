#==============================================================================
# Print Start G-code (start even if nozzle is above target)
#==============================================================================
[gcode_macro PRINT_START]
gcode:
    _SET_FLAP_ENABLED ENABLED=1
    lights_max
    M220 S100
    G90

    # Params (with sane defaults if slicer doesn't pass them)
    {% set bedtemp = params.BED|default(60)|int %}
    {% set hotendtemp = params.HOTEND|default(210)|int %}

    # Start heating early (no waiting yet)
    M140 S{bedtemp}          ; set bed (no wait)
    M104 S{hotendtemp}       ; set hotend (no wait)

    M190 S{bedtemp}          ; wait for bed
    G28                      ; home all
    _CLIENT_LINEAR_MOVE Z=5 F=1500

    ; BED_MESH_CALIBRATE ADAPTIVE=0  ; (optional)
    ; NOZZLE_WIPE_LOCATION_READY     ; (optional)

    # Key line: wait only if BELOW target; if above, continue immediately
    M109 R{hotendtemp}

    ; NOZZLE_WIPE                   ; (optional)
    PRIME_LINE
